# 产品需求文档 (PRD)：KnowledgeMind - 企业知识库 Agent

> **生成时间**：2025-02-16
> **基于路线图**：Agent 应用开发（JS/TS 路线）
> **产品阶段**：MVP 开发计划

---

## 一、执行摘要

### 1.1 产品概述

| 项目 | 内容 |
|------|------|
| **产品名称** | KnowledgeMind (知识智脑) |
| **一句话描述** | 企业私有化 AI 知识库，让团队文档「活」起来 |
| **核心价值** | 上传文档即可获得专属 AI 助手，数据不出域，安全可控 |
| **目标用户** | 中小企业、专业服务机构（律所、咨询）、技术团队 |
| **当前阶段**：MVP 开发计划 |

### 1.2 产品定位图

```
┌─────────────────────────────────────────────────────────┐
│                         用户痛点                          │
├─────────────────────────────────────────────────────────┤
│ • 企业文档散落各地，查找困难                              │
│ • 新人培训成本高，重复问题占用资深员工时间                │
│ • 知识随人员流失而流失                                    │
│ • 公有云 AI 存在数据泄露风险                              │
│ • 通用 AI（如 ChatGPT）不了解企业内部信息                 │
└─────────────────────────────────────────────────────────┘
                            ↓ RAG 解决
┌─────────────────────────────────────────────────────────┐
│                         KnowledgeMind 方案               │
├─────────────────────────────────────────────────────────┤
│ • 一键上传文档，自动向量化索引                            │
│ • 自然语言提问，精准定位答案+来源引用                     │
│ • 多轮对话追问，深入理解知识                              │
│ • 私有化部署，数据完全可控                                │
│ • 支持多种文档格式（PDF、Word、Excel、Markdown）          │
└─────────────────────────────────────────────────────────┘
                            ↓ 创造
┌─────────────────────────────────────────────────────────┐
│                         用户价值                          │
├─────────────────────────────────────────────────────────┤
│ • 查找效率提升 90%，从小时级到秒级                        │
│ • 新人上手速度提升 70%，减少导师投入                      │
│ • 企业知识资产沉淀，避免人员流失损失                      │
│ • 数据安全合规，满足行业监管要求                          │
└─────────────────────────────────────────────────────────┘
```

### 1.3 验证学习的核心技能

| 学习路线技能 | 产品中的应用形式 | 验收方式 |
|-------------|-----------------|---------|
| **RAG 检索增强** | 文档向量化、语义检索、答案生成 | 上传文档后能准确回答相关问题 |
| **向量数据库** | 文档 Embedding 存储与相似度搜索 | 返回结果有相关性评分 |
| **LLM 调用** | 答案生成、多轮对话管理 | 自然流畅的对话体验 |
| **文档处理** | PDF/Word/Excel 解析与切片 | 支持多种格式，切片合理 |
| **记忆系统** | 对话历史管理、用户偏好记忆 | 支持追问和上下文理解 |
| **来源引用** | 答案附带文档出处 | 每个答案标注来源文档和页码 |

---

## 二、市场分析

### 2.1 目标市场

**一级市场（核心市场）**
- **定义**：20-200 人的中小企业
- **规模**：中国约 400 万家中小企业，有知识管理需求的约 5%
- **特征**：有文档积累，但缺乏专业 KM 系统，预算有限但重视效率

**二级市场（扩展市场）**
- **定义**：专业服务机构（律所、咨询、会计师事务所）
- **规模**：约 50 万家
- **特征**：知识密集型，付费意愿强，对安全要求极高

### 2.2 竞品分析

| 竞品 | 核心功能 | 定价 | 优势 | 劣势 | 我们的差异化 |
|------|---------|------|------|------|-------------|
| **Dify** | LLM 应用开发平台 | ¥199-3999/月 | 功能强大、开源 | 需要技术门槛、复杂 | 开箱即用、零配置 |
| **FastGPT** | 知识库问答 | 开源/云版 | 国内化好 | 需要自部署或用云版 | 本地优先、更简单 |
| **Pinecone** | 向量数据库 | $70-708/月 | 性能强 | 纯数据库、需开发 | 完整解决方案 |
| **ChatDOC** | 文档问答 | 按文档收费 | 即用性好 | 单文档处理、无企业级 | 企业知识库视角 |
| **飞书知识库** | 文档管理 | 订阅制 | 与IM集成 | AI 能力弱、私有化贵 | 专注 AI 问答 |

### 2.3 SWOT 分析

```
         内部因素                          外部环境
            ↓                                 ↓
┌───────────────────┐              ┌───────────────────┐
│  Strengths (优势)  │              │  Opportunities    │
│  • 全栈开发能力    │              │  • 企业数字化加速 │
│  • RAG 创业项目经验 │              │  • 数据合规要求   │
│  • 3090 本地模型   │              │  • AI 原生一代到来 │
│  • 本地部署能力    │              │  • 垂直行业机会   │
└───────────────────┘              └───────────────────┘

┌───────────────────┐              ┌───────────────────┐
│  Weaknesses (劣势) │              │  Threats (威胁)   │
│  • 初创品牌认知    │              │  • 大厂竞品（钉钉、飞书）│
│  • 单人开发资源    │              │  • 开源方案竞争   │
│  • 企业销售经验少  │              │  • 技术门槛降低   │
└───────────────────┘              └───────────────────┘
```

---

## 三、产品功能

### 3.1 功能优先级矩阵

| 优先级 | 功能模块 | 描述 | 对应技能 | 开发估时 |
|--------|---------|------|---------|---------|
| 🔴 P0 | 文档上传与解析 | 支持拖拽上传，自动解析 PDF/Word/Excel/MD | 文档处理 | 4天 |
| 🔴 P0 | 向量化与索引 | 文档切片、Embedding、向量存储 | 向量数据库 | 5天 |
| 🔴 P0 | 语义问答 | 自然语言提问，检索相关文档片段 | RAG 检索 | 5天 |
| 🔴 P0 | 来源引用 | 答案附带文档出处和页码 | RAG 增强 | 3天 |
| 🔴 P0 | 多轮对话 | 支持追问，上下文记忆 | 记忆系统 | 3天 |
| 🟡 P1 | 权限管理 | 文档/知识库级别的访问控制 | - | 5天 |
| 🟡 P1 | 本地部署 | Docker 一键部署，支持私有化 | 部署能力 | 4天 |
| 🟡 P1 | 数据源集成 | 支持从 Notion、Confluence、飞书同步 | API 集成 | 6天 |
| 🟢 P2 | 多模态 | 支持图片、表格解析 | 多模态 AI | 5天 |
| 🟢 P2 | 知识图谱 | 文档关系可视化 | 图数据库 | 8天 |

### 3.2 MVP 功能范围（P0）

**MVP 目标**：验证「私有化企业知识库问答」的核心价值——上传文档，智能问答

| 功能 | 用户故事 | 验收标准 | 技术实现要点 |
|------|---------|---------|-------------|
| **文档上传** | 作为员工，我希望上传公司文档到知识库，以便团队共享 | 拖拽上传 PDF/Word/Excel/Markdown，显示解析进度 | 使用 pdf-parse、mammoth、xlsx 库解析 |
| **智能问答** | 作为员工，我希望用自然语言提问，获得准确答案 | 输入问题后 3 秒内返回答案，附带来源 | RAG 检索 + LLM 生成 |
| **来源引用** | 作为员工，我希望看到答案的来源，以便验证准确性 | 每个答案标注文档名称和页码 | 检索时保留元数据 |
| **多轮对话** | 作为员工，我希望能够追问，深入了解更多细节 | 支持 5 轮以上对话，AI 能记住上下文 | 对话历史管理 |
| **知识库管理** | 作为管理员，我希望管理知识库和文档 | 查看所有文档、删除、重新索引 | CRUD 操作 |

### 3.3 后续迭代规划

**V1.0 后计划**：
- **V1.1**（MVP+2周）：权限管理 - 文档级别访问控制
- **V1.2**（MVP+4周）：本地部署 - Docker Compose 一键部署
- **V2.0**（MVP+8周）：数据源集成 - Notion、飞书、Wiki 同步
- **V3.0**（MVP+12周）：知识图谱 - 文档关系可视化、智能推荐

---

## 四、用户体验设计

### 4.1 用户旅程地图

```
[注册登录] → [创建知识库] → [上传文档] → [等待索引] → [开始提问] → [获得答案] → [查看来源]
    ↓           ↓            ↓            ↓            ↓            ↓            ↓
  邮箱注册    命名知识库   拖拽上传    进度提示    自然语言    即时响应    点击跳转
```

### 4.2 核心页面/交互

| 页面/交互 | 目的 | 关键元素 | 对应技能点 |
|----------|------|---------|-----------|
| **知识库列表页** | 展示所有知识库 | 卡片视图、文档数量、最近更新 | - |
| **知识库详情页** | 文档管理 | 文档列表、上传按钮、搜索框 | 文档管理 |
| **文档上传页** | 上传与解析 | 拖拽区域、格式提示、解析进度 | 文档解析 |
| **问答对话页** | 核心交互 | 对话界面、来源卡片、追问按钮 | RAG + 流式输出 |
| **设置页** | 系统配置 | Embedding 模型选择、API 配置 | LLM 配置 |

### 4.3 用户体验原则

1. **零配置启动** - 默认配置即可用，高级配置可选
2. **透明反馈** - 上传、索引、检索各阶段都有明确反馈
3. **可信答案** - 每个答案都标注来源，支持点击跳转
4. **快速响应** - 首字响应 < 1 秒，完整答案 < 3 秒

---

## 五、技术架构

### 5.1 技术栈选型

| 层级 | 技术选型 | 理由 | 对应学习技能 |
|------|---------|------|-------------|
| 前端 | Next.js 14 + Shadcn UI | 你熟悉的技术栈 | React 前端开发 |
| AI SDK | Vercel AI SDK | 路线图推荐，流式支持好 | LLM 调用、流式输出 |
| 向量数据库 | pgvector / SQLite-VSS | 轻量级，可本地部署 | 向量数据库 |
| Embedding | 本地模型(3090) / OpenAI | 本地优先降级到云端 | RAG 基础 |
| 文档解析 | pdf-parse, mammoth, xlsx | 支持主流格式 | 文档处理 |
| 后端 | Next.js API Routes | 全栈一体 | Node.js 开发 |
| 部署 | Docker + Docker Compose | 私有化部署标准 | 你的部署经验 |

### 5.2 系统架构图

```
┌─────────────────────────────────────────────────────────┐
│                       用户端                             │
│              Web (Next.js + Shadcn UI)                   │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                      API 层                              │
│           (Next.js API Routes + Vercel AI SDK)           │
└─────────────────────────────────────────────────────────┘
                            ↓
┌─────────────┬─────────────┬─────────────┬─────────────┐
│  文档服务   │  向量服务   │  对话服务   │  用户服务   │
│  • 上传     │  • Embedding │  • RAG检索 │  • 认证     │
│  • 解析     │  • 存储     │  • 答案生成 │  • 权限     │
│  • 切片     │  • 相似度搜索 │  • 历史管理 │  • 配额     │
└─────────────┴─────────────┴─────────────┴─────────────┘
       ↓              ↓              ↓              ↓
┌─────────────┬─────────────┬─────────────┬─────────────┐
│  文件存储   │  pgvector   │  LLM API    │  PostgreSQL │
│  (MinIO/S3) │  (向量存储) │  (本地/云端) │  (元数据)   │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

### 5.3 数据模型（核心实体）

```typescript
// 知识库
KnowledgeBase {
  id: string
  name: string
  description?: string
  ownerId: string
  embeddingModel: string
  createdAt: Date
  updatedAt: Date
}

// 文档
Document {
  id: string
  knowledgeBaseId: string
  filename: string
  fileType: 'pdf' | 'docx' | 'xlsx' | 'md' | 'txt'
  fileSize: number
  uploadStatus: 'pending' | 'processing' | 'completed' | 'failed'
  chunkCount: number
  uploadedAt: Date
  indexedAt?: Date
}

// 文档切片
Chunk {
  id: string
  documentId: string
  content: string
  embedding: number[]           // 向量
  metadata: {
    pageNumber?: number
    section?: string
    filename: string
  }
}

// 对话会话
Conversation {
  id: string
  knowledgeBaseId: string
  userId: string
  title?: string                  // 从首条消息自动生成
  createdAt: Date
  updatedAt: Date
}

// 消息
Message {
  id: string
  conversationId: string
  role: 'user' | 'assistant'
  content: string
  sources?: Source[]             // 答案附带来源
  createdAt: Date
}

// 来源引用
Source {
  documentId: string
  filename: string
  pageNumber?: number
  chunkId: string
  score: number                  // 相似度分数
}
```

### 5.4 技术风险与应对

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|---------|
| 检索准确率不足 | 中 | 高 | 优化切片策略、混合检索（关键词+向量）、重排序 |
| 本地模型性能问题 | 中 | 中 | 云端降级方案、模型量化、缓存 |
| 大文档处理超时 | 中 | 中 | 分片上传、异步处理、进度反馈 |
| 并发查询性能 | 低 | 中 | 连接池、查询缓存、水平扩展 |

---

## 六、商业模式

### 6.1 盈利模式

| 模式 | 描述 | 定价策略 | 目标占比 |
|------|------|---------|---------|
| **SaaS 订阅** | 云端版本，按座位和容量收费 | 分档定价 | 50% |
| **私有化授权** | 一次性购买 + 年度维保 | 一次性收费 | 30% |
| **定制开发** | 垂直行业定制（如法律版、医疗版） | 项目制 | 20% |

**推荐模式**：SaaS + 私有化双轨 - 不同客户需求兼顾

### 6.2 定价策略

#### SaaS 版本（云服务）

| 套餐 | 目标用户 | 价格 | 包含功能 | 限制 |
|------|---------|------|---------|------|
| **个人版** | 个人知识管理 | ¥0 | • 1个知识库<br>• 100MB存储<br>• 基础问答 | • 仅个人使用 |
| **团队版** | 小团队 | ¥199/月 | • 5个知识库<br>• 5GB存储<br>• 5个账号<br>• 权限管理 | • 不支持私有化 |
| **企业版** | 中小企业 | ¥899/月 | • 20个知识库<br>• 50GB存储<br>• 20个账号<br>• API接入<br>• 优先支持 | • SLA 99.5% |

#### 私有化版本（本地部署）

| 版本 | 目标用户 | 价格 | 包含内容 |
|------|---------|------|---------|
| **标准版** | 中小企业 | ¥9,800/次 | • Docker 部署包<br>• 年度维保 ¥2,000<br>• 支持 50 用户 |
| **企业版** | 大型企业 | ¥49,800/次 | • 私有化部署支持<br>• 年度维保 ¥10,000<br>• 不限用户<br>• 定制培训 |

### 6.3 获客策略

**有机增长**：
- **技术内容** - "RAG 实战"、"本地知识库搭建"等教程
- **开源组件** - 开源核心知识库组件，建立技术影响力
- **案例研究** - 真实客户案例展示

**付费增长**：
- **搜索广告** - "企业知识库"、"私有化 ChatGPT"等关键词
- **行业会议** - 数字化转型、企业效率相关会议

**合作伙伴**：
- **系统集成商** - 与企业 IT 服务商合作推广
- **SaaS 生态** - 入驻钉钉、企业微信应用市场

---

## 七、运营指标

### 7.1 北极星指标

**核心指标**：周活跃问答数 (Weekly Active Queries)

**原因**：直接反映知识库被使用的程度，比用户数更能体现价值

### 7.2 分阶段指标

**阶段1：MVP 验证期（0-3个月）**

| 指标类型 | 指标 | 目标值 | 当前值 |
|---------|------|--------|--------|
| 获取 | 注册用户数 | 300 | - |
| 激活 | 创建知识库比例 | 50% | - |
| 留存 | 次周问答数 > 10 | 40% | - |
| 变现 | 付费转化率 | 3% | - |

**阶段2：增长期（3-12个月）**

| 指标类型 | 指标 | 目标值 | 当前值 |
|---------|------|--------|--------|
| 获取 | 月新增用户 | 1000 | - |
| 激活 | 月活跃知识库 | 500 | - |
| 留存 | 3月留存率 | 50% | - |
| 变现 | MRR | ¥5万 | - |

### 7.3 成本结构

| 成本项 | 月成本（¥） | 说明 |
|--------|------------|------|
| 服务器/云服务 | 3000 | Vercel Pro + 文件存储 |
| 第三方服务 | 2000 | OpenAI API（降级用） |
| 营销推广 | 3000 | 内容 + 搜索广告 |
| 其他 | 1000 | 域名、客服工具 |
| **合计** | **9000** | |

### 7.4 收入预测（保守/中性/乐观）

| 时间 | 保守收入 | 中性收入 | 乐观收入 | 说明 |
|------|---------|---------|---------|------|
| 月3 | ¥1,000 | ¥3,000 | ¥6,000 | 5-30个付费用户 |
| 月6 | ¥5,000 | ¥15,000 | ¥30,000 | 20-100个付费用户 |
| 月12 | ¥20,000 | ¥60,000 | ¥150,000 | 80-400个付费用户 |

---

## 八、开发计划

### 8.1 里程碑规划

| 阶段 | 目标 | 时间 | 交付物 | 状态 |
|------|------|------|--------|------|
| 需求确认 | 明确所有 MVP 需求 | Week 1 | 本 PRD 文档 | ✅ |
| 技术设计 | 架构设计 + 技术选型 | Week 2 | 架构图 + 技术方案 | ⬜ |
| MVP开发 | 核心功能实现 | Week 3-7 | 可用版本 | ⬜ |
| 内测 | 邀请30用户测试 | Week 8-9 | 测试报告 | ⬜ |
| 公开上线 | 产品正式发布 | Week 10 | 正式版 v1.0 | ⬜ |
| 私有化版本 | Docker 部署包 | Week 12+ | 私有化版本 | ⬜ |

### 8.2 技术任务分解

**Week 1-2：基础设施**
- [ ] Next.js 项目初始化 - 1天
- [ ] 数据库设计（PostgreSQL + pgvector） - 2天
- [ ] 用户认证系统 - 2天

**Week 3-4：文档处理**
- [ ] 文档上传与解析（对应技能：文档处理） - 4天
- [ ] 文档切片与 Embedding（对应技能：向量数据库） - 3天

**Week 5-6：RAG 问答**
- [ ] 向量检索服务（对应技能：RAG 基础） - 3天
- [ ] 答案生成与来源引用（对应技能：LLM 调用） - 4天

**Week 7：对话管理**
- [ ] 多轮对话与历史管理（对应技能：记忆系统） - 3天
- [ ] 前端界面完善 - 4天

**Week 8-9：测试与修复**
- [ ] 内测用户招募与测试 - 7天
- [ ] Bug 修复与优化 - 7天

### 8.3 技能验证检查清单

| 学习路线技能 | 产品对应功能 | 完成标准 | 验证方式 |
|-------------|-------------|---------|---------|
| **RAG 检索增强** | 语义问答功能 | 能准确回答文档相关问题 | 上传测试文档验证 |
| **向量数据库** | 文档 Embedding 存储 | 检索返回相关性 > 0.7 | 测试集验证 |
| **LLM 调用** | 答案生成 | 答案自然流畅、准确 | 人工评估 |
| **记忆系统** | 多轮对话 | 支持 5 轮以上追问 | 对话测试 |
| **文档处理** | 多格式解析 | 支持主流格式 | 各种格式测试 |

---

## 九、风险评估

### 9.1 风险矩阵

| 风险 | 可能性 | 影响 | 风险等级 | 应对策略 |
|------|--------|------|---------|---------|
| 检索质量不达预期 | 中 | 高 | 🟡 | 混合检索、重排序、用户反馈学习 |
| 与大厂竞品竞争 | 高 | 高 | 🟡 | 聚焦中小企业、本地部署优势 |
| 数据泄露风险 | 低 | 高 | 🟢 | 私有化选项、安全审计 |
| 单人开发进度 | 中 | 中 | 🟢 | MVP 范围控制、复用创业项目代码 |

### 9.2 止损条件

**项目暂停/终止的条件**：
1. **3个月内付费转化率 < 2%** - 产品-市场匹配度不够
2. **用户问答准确率 < 70%** - 核心体验不达标
3. **CAC > LTV/2** - 商业模式不成立

---

## 十、附录

### 10.1 参考资料
- [Vercel AI SDK RAG 示例](https://sdk.vercel.ai/docs)
- [pgvector 文档](https://github.com/pgvector/pgvector)
- [LangChain.js RAG 教程](https://js.langchain.com/docs/tutorials/rag)

### 10.2 术语表
| 术语 | 解释 |
|------|------|
| RAG | Retrieval Augmented Generation，检索增强生成 |
| Embedding | 文本向量化，将文本转换为数学向量 |
| Chunk | 文档切片，将长文档切分成小段 |
| 相似度搜索 | 基于向量相似度的检索方式 |

### 10.3 变更记录

| 版本 | 日期 | 变更内容 | 负责人 |
|------|------|---------|--------|
| v1.0 | 2025-02-16 | 初始版本 | AI生成 |

---

*文档版本：v1.0 | 最后更新：2025-02-16*
